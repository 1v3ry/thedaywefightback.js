
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <!-- Bootstrap core CSS -->
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
    <link href="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.0.0/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="styles.css" />
</head>

<body>
    <div id="#pt-main">
        <div class="pt-page" id="firstslide">
            <img src="imgs/splash.png" id="splash" />
        </div>
        <div class="pt-page" id="secondslide" style="display: none;">
            <div class="row">
                <div class="col-md-6"></div>
                <div class="col-md-3">
                    <p>
                        <form method="get" action="http://call.taskforce.is/create" id="call-form" role="form" class="form-horizontal">
                            <div class="form-group">
                                <label class=" control-label" for="userPhone">CALL YOUR LEGISLATOR!</label>
                                <br />
                                <div class="c">
                                    <input type="tel" name="userPhone" class="form-control" id="userPhone">
                                </div>
                            </div>
                            <input type="hidden" value="restrict-nsa" name="campaignId">
                            <span id="error-text"></span>
                            <input id="submit" type="Submit" value="Call Now" class="btn  btn-primary">
                        </form>
                    </p>
                </div>
                <div class="col-md-3">
                    <p>
                        <form method="get" action="http://call.taskforce.is/create" id="call-form" role="form" class="form-horizontal">
                            <div class="form-group">
                                <label class=" control-label" for="userPhone">EMAIL YOUR LEGISLATOR!</label>
                                <br />
                                <div class="">
                                    <input type="tel" name="userPhone" class="form-control" id="userPhone">
                                </div>
                            </div>
                            <input type="hidden" value="restrict-nsa" name="campaignId">
                            <span id="error-text"></span>
                            <input id="submit" type="Submit" value="Call Now" class="btn  btn-primary">
                        </form>
                    </p>
                </div>
            </div>
            <div class="footer">
            <div class="container">
                <p>Outside the US?
                </p></div>
            </div>
        </div>
    </div>
    <script type="text/javascript">
    function isValidPhoneNumber(value) {
        if (!value) return false;
        var count = value.replace(/[^0-9]/g, "").length;

        return count == 10 || count == 11;
    }

    function isValidZipCode(value) {
        if (!value) return false;
        var count = value.replace(/[^0-9]/g, "").length;

        return count == 5;
    }


    var zipCodeError = function(el) {
        document.getElementById("error-text").innerHTML += "Invalid Zip";

    };

    var phoneError = function(el) {
        document.getElementById("error-text").innerHTML += "Invalid Phone";
    };


    // On form submit, validate fields

    var onFormSubmit = function(e) {
        document.getElementById("error-text").innerHTML = "";
        e.preventDefault();
        var userZip = document.getElementById("userZip");
        var userPhone = document.getElementById("userPhone");

        console.log(isValidZipCode(userZip.value), isValidPhoneNumber(userPhone.value));

        var errors = false;

        // Valid Zip?
        if (!isValidZipCode(userZip.value)) {
            zipCodeError(userZip);
            errors = true;
        }

        // Valid Phone?
        if (!isValidPhoneNumber(userPhone.value)) {
            phoneError(userPhone);
            errors = true;
        }

        if (errors) {
            return false;
        }


        // Instead of sending an ajax request, lets just assume success and create an iframe to do the call
        var iframe = document.createElement('iframe');
        iframe.style.display = "none";
        iframe.src = 'http://call.taskforce.is/create';
        document.body.appendChild(iframe);

        // Hide form etc below here;

        return false;
    }

    // Attach listener to call form

    var ele = document.getElementById("call-form");
    if (ele.addEventListener) {
        ele.addEventListener("submit", onFormSubmit, false); //Cool modern browser!
    } else if (ele.attachEvent) {
        ele.attachEvent('onsubmit', onFormSubmit); //The evil IE needs extra
    }
    setTimeout(function() {
        $('.first-slide').fadeOut(400, function() {
            $('.second-slide').fadeIn(300);
        })
    }, 1000);
    </script>
</body>

</html>
